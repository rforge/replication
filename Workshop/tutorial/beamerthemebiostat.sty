%% ----------------------------------------------------------------------------
%% beamerthemebiostat.sty
%%
%% Beamer theme for Biostat presentation.
%%    History:
%%      16.02.2017: initial version
%%      01.08.2019: samuel version
%%
%% Based on Beamer theme "uzhneu-de", "uzhneu-en", by Corporate Design
%%  templates for the University of Zurich, new version as of October 2010.
%%
%% Copyright 2010 by Jürgen Spitzmüller <spitzmueller@ds.uzh.ch>
%% Modification copyright 2017 Reinhard Furrer <reinhard.furrer@math.uzh.ch>
%% Further modifications by Samuel Pawel for master thesis presentations in 2019
%%
%% This template can be redistributed and/or modified under the terms
%% of the GNU Public License, version 2 or later.
%% ----------------------------------------------------------------------------

% ----------------------------------------------------------------------------
% Installation of arial font in ubuntu 18.04:
% cd Downloads/
% wget -q https://www.tug.org/fonts/getnonfreefonts/install-getnonfreefonts
% sudo texlua ./install-getnonfreefonts
% sudo getnonfreefonts --sys -a
% ----------------------------------------------------------------------------

\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage[english]{babel}
\usepackage{pgfpages}           % necessary for the handouts production
\usepackage{amsmath}            % for nice mathematics
\usepackage{verbatim}           % for verbatim output
\usepackage{wasysym}            % symbols (smilies etc.)
\usepackage{longtable}
\usepackage{float}
\usepackage{textcomp}
\usepackage{graphicx}
\usepackage{xcolor} % for the color names, see: http://en.wikibooks.org/wiki/LaTeX/Colors#Predefined_
\usepackage{hyperref}
\hypersetup{%
    colorlinks=false,%
    urlcolor=uzh@orange,% defined below
    backref=page,
    pdfstartview=Fit,%
    pdfpagelayout=SinglePage,%
    pdfpagemode=UseThumbs
  }%
\usepackage{url}
\DeclareOptionBeamer{compress}{\beamer@compresstrue}
\ProcessOptionsBeamer

\mode<presentation>

\def\uzhunit{}
\def\uzhunitext{}


% Logo
\pgfdeclareimage[height=.9cm]{uzhlogo}{uzh_logo_e_pos}

% adjust margins
\setbeamersize{text margin left=1.25cm}
\setbeamersize{text margin right=1.25cm}

% fonts
\usefonttheme{default}
\RequirePackage{uarial}
\setbeamerfont{title}{size={\fontsize{24}{24pt}\selectfont},parent=structure,series=\bfseries}
\setbeamerfont{subtitle}{size={\fontsize{10}{11pt}\selectfont},series=\mdseries}
\setbeamerfont{author}{size={\fontsize{10}{11pt}\selectfont},series=\mdseries}
\setbeamerfont{footline}{size={\fontsize{5}{7pt}\selectfont}}
\setbeamercolor{footline}{fg=black}
\setbeamerfont{frametitle}{parent=structure,size={\fontsize{12}{12pt}\selectfont},series=\bfseries}
\setbeamerfont{framesubtitle}{parent=frametitle,size=\footnotesize}
\setbeamerfont{uzhunit}{size={\fontsize{7}{9pt}\selectfont},series=\bfseries}
\setbeamerfont{uzhunitext}{size={\fontsize{5}{7pt}\selectfont},series=\mdseries}

% colors
\usecolortheme{default}
\definecolor{uzh@blue}{RGB}{0,40,165}
\definecolor{uzh@grey}{RGB}{163,173,183}
\definecolor{uzh@orange}{RGB}{220,96,39}
\definecolor{green2}{RGB}{0,102,0}
\definecolor{darkmagenta}{rgb}{0.55, 0.0, 0.55}
\setbeamercolor{structure}{fg=uzh@blue}
\setbeamercolor{titlelike}{fg=black}
\setbeamercolor{title}{fg=uzh@blue}
\setbeamercolor{frametitlelike}{fg=uzh@blue}
\setbeamercolor{frametitle}{parent=frametitlelike}
\setbeamercolor{framesubtitle}{parent=frametitle}
\setbeamercolor{mini frame}{parent=structure}
\setbeamercolor{sepline}{fg=uzh@grey,bg=uzh@grey}
\setbeamercolor{partpage}{fg=white,bg=uzh@grey}
\setbeamercolor{itemize item}{fg=black}
\setbeamercolor{enumerate item}{fg=black}
\RequirePackage{url}
\def\UrlFont{\sffamily\color{uzh@orange}}


% Inner Theme
\useinnertheme{default}

% Layout/placement
\useoutertheme{default}

% date
\newcommand{\leadingzero}[1]{\ifnum #1<10 0\the#1\else\the#1\fi}
\AtBeginDocument{%
\@ifundefined{addto}{}{%
\addto\captionsngerman{\def\datengerman{\def\today{\leadingzero{\day}.\leadingzero{\month}.\the\year}}}
\addto\captionsenglish{\def\dateenglish{\def\today{\leadingzero{\day}/\leadingzero{\month}/\the\year}}}
}}

% Title page
\defbeamertemplate*{title page}{uzh}[1][]
{
%   \begin{beamercolorbox}[left]{}
% 	  \pgfuseimage{uzhlogo}\par
% 	  \vspace*{1.6mm}\hspace*{10mm}\usebeamerfont{uzhunit}\uzhunit\enspace\usebeamerfont{uzhunitext}\uzhunitext
%   \end{beamercolorbox}
  \vskip.8em
    \begin{beamercolorbox}[sep=0pt,left,#1]{title}
      \usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle\par%
      \ifx\insertsubtitle\@empty%
      \else%
        \vskip0.5em%
        {\usebeamerfont{subtitle}\usebeamercolor[fg]{titlelike}\insertsubtitle\par}%
      \fi%
    \end{beamercolorbox}%
    \vskip0.5em%
    \begin{beamercolorbox}[sep=0pt,left,#1]{author}
      \usebeamerfont{author}\insertauthor\par%
      \ifx\insertinstitute\@empty%
      \else%
        \vskip0.25em%
        {\usebeamerfont{institute}\insertinstitute\par}%
      \fi%
    \end{beamercolorbox}
    {\usebeamercolor[fg]{titlegraphic}\inserttitlegraphic\par}
  \vfill
}

\def\maketitle{%
\ifbeamer@inframe
    \titlepage
\else
     \setbeamertemplate{footline}[title page]
     \frame{\titlepage}
     \setbeamertemplate{footline}[uzh]
\fi}

% Placement of frame titles
\defbeamertemplate*{frametitle}{uzh}[1][left]
{
  \ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
  \@tempdima=\textwidth%
  \advance\@tempdima by\beamer@leftmargin%
  \advance\@tempdima by\beamer@rightmargin%
  % \vskip .1em
  \begin{beamercolorbox}[#1,wd=\the\@tempdima, leftskip=1.25cm]{}
   \begin{minipage}{\textwidth}
    \raggedright
    \usebeamerfont{frametitle}%
    \if@tempswa\else\csname beamer@fte#1\endcsname\fi%
    \strut\insertframetitle\strut\par%
    {%
      \ifx\insertframesubtitle\@empty%
      \else%
      {\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle\strut\par}%
      \fi
    }%
  \end{minipage}
  \end{beamercolorbox}%
}

% Part page
\newlength\frameheightmhead
\setlength\frameheightmhead{\textheight}
\addtolength\frameheightmhead{1.55em}
\newlength\frameheightohead
\setlength\frameheightohead{\textheight}
\addtolength\frameheightohead{-.7em}

\defbeamertemplate*{part page}{uzh}[1][left]
{
  \ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
  \@tempdima=\textwidth%
  \advance\@tempdima by\beamer@leftmargin%
  \advance\@tempdima by\beamer@rightmargin%
%
  \vspace*{-.13em}
  \begin{beamercolorbox}[wd=\the\@tempdima, ht=\frameheightmhead, leftskip=1.25cm]{partpage}
    \usebeamerfont{frametitle}%
    \vskip .7em
    \insertpart\\%
    \vspace*{\frameheightohead}
   \end{beamercolorbox}%
}

\defbeamertemplate{footline}{part page}{}

\AtBeginPart{%
   \setbeamertemplate{footline}[part page]
   \frame{\partpage}
   \setbeamertemplate{footline}[uzh]
}

% no navigation symbols
\setbeamertemplate{navigation symbols}{}

% pagination (excluding appendices)
\def\insertpresentationframenumber{\inserttotalframenumber}

%\newcommand\framepagination{\insertframenumber\,/\,\insertpresentationframenumber}
\newcommand\framepagination{Page \insertframenumber}

\let\oldappendix\appendix
\renewcommand*\appendix{%
\if@filesw
    \immediate\write\@auxout{\string\@writefile{nav}%
       {\noexpand\headcommand{\noexpand\def\noexpand\insertpresentationframenumber{\the\c@framenumber}}}}
\fi
\renewcommand\framepagination{\appendixname\ (\insertframenumber )}
\oldappendix}

% headline
% \defbeamertemplate*{headline}{uzh_title}
% {%
%       \begin{beamercolorbox}[sep=0.25cm]{}
% 	\pgfuseimage{uzhlogo}\par
% 	\vspace*{1.6mm}\hspace*{10mm}\usebeamerfont{uzhunit}\uzhunit\enspace\usebeamerfont{uzhunitext}\uzhunitext
%       \end{beamercolorbox}
%       \vspace*{-1.8mm}
%       \begin{beamercolorbox}[wd=\textwidth,ht=.2mm]{sepline}
%       \end{beamercolorbox}
%       %% Test if a key visual is defined and insert it, if so.
%       {\def\pgf@imagename{pgf@image@kernsujet}%
%        \pgf@tryextensions{\pgf@imagename}{\pgfalternateextension}%
%        \expandafter\pgfutil@ifundefined\expandafter{\pgf@imagename}%
%        {}%
%        {
%         \begin{pgfpicture}
%         \put(186.5,0.75){\pgfuseimage{kernsujet}}
%         \end{pgfpicture}
%        }%
%       }%
% }

% footline
\defbeamertemplate*{footline}{uzh}
{\hspace{\beamer@leftmargin}%
	\usebeamerfont{footline}%
	\ifx\beamer@shortdate\@empty%
	\else
	\insertshortdate\hspace{1em}%
	\fi
	\insertshorttitle
	\hfill
	\framepagination\hspace*{\beamer@rightmargin}
	\vskip2ex
}

% footline
\defbeamertemplate*{footline}{title page}
{\hspace{\beamer@leftmargin}%
	\usebeamerfont{footline}%
	\ifx\beamer@shortdate\@empty%
	\else
	\insertshortdate%
	\fi
	\hfill
	%\framepagination\hspace*{\beamer@rightmargin}
	\vskip2ex
}

% Misc.
\setbeamercovered{transparent=0}
% \setbeamertemplate{sections in toc}[sections numbered]

% Itemize items
\defbeamertemplate*{itemize item}{uzh}{\hbox{--}}
\defbeamertemplate*{itemize subitem}{uzh}{\hbox{--}}
\defbeamertemplate*{itemize subsubitem}{uzh}{\hbox{--}}

% Bibliography
\setbeamertemplate{bibliography item}[triangle]
\renewcommand{\@cite}[2]{\textcolor{structure}{#1\if@tempswa :\,#2\fi}}
\setbeamertemplate{bibliography entry title}{ }
\setbeamertemplate{bibliography entry location}{ }
\setbeamertemplate{bibliography entry note}{ }
\setbeamercolor{bibliography entry author}{use=structure,fg=structure.fg}
\setbeamercolor{bibliography entry title}{use=normal text,fg=normal text.fg}
\setbeamercolor{bibliography entry location}{use=normal text,fg=normal text.fg}
\setbeamercolor{bibliography entry note}{use=normal text,fg=normal text.fg}

% Notes
\defbeamertemplate*{note page}{uzh}
{%
  {%
    \scriptsize
%    \insertvrule{.25\paperheight}{white!90!black}
%    \vskip-.25\paperheight
    \nointerlineskip
    \vbox{
      \hfill\insertslideintonotes{0.7}\hskip-\Gm@rmargin\hskip0pt%
%      \vskip-0.25\paperheight%
      \vfil}%
  }%
  \vskip.25em
  \nointerlineskip
  \insertnote
}
\renewcommand{\baselinestretch}{1.15}
\setlength{\parskip}{1.0em}

\mode
<all>

% Sectionpage without numbering
\setbeamertemplate{section page}
{
    \begin{centering}
    \begin{beamercolorbox}[sep=12pt,center]{part title}
    \usebeamerfont{section title}\insertsection\par
    \end{beamercolorbox}
    \end{centering}
}
% ----------------------------------------------------------------------------